<!DOCTYPE html>

<html>
<head>
  <title>IperGraph.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="index.html">
                index.js
              </a>
            
              
              <a class="source" href="IperEdge.html">
                IperEdge.js
              </a>
            
              
              <a class="source" href="IperElement.html">
                IperElement.js
              </a>
            
              
              <a class="source" href="IperGraph.html">
                IperGraph.js
              </a>
            
              
              <a class="source" href="IperNode.html">
                IperNode.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>IperGraph.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>IperGraph</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="keyword">var</span> _    = require(<span class="string">'underscore'</span>)
  , util = require(<span class="string">'util'</span>)

<span class="keyword">var</span> IperEdge    = require(<span class="string">'./IperEdge'</span>)
  , IperElement = require(<span class="string">'./IperElement'</span>)
  , IperNode    = require(<span class="string">'./IperNode'</span>)

<span class="function"><span class="keyword">function</span> <span class="title">IperGraph</span><span class="params">(data)</span> {</span>

  IperElement.call(<span class="keyword">this</span>)

  <span class="keyword">if</span> (_.isUndefined(data))
    data = {nodes:{}, edges:{}}

  <span class="keyword">this</span>.__defineGetter__(<span class="string">'edges'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> data.edges })
  <span class="keyword">this</span>.__defineGetter__(<span class="string">'nodes'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> data.nodes })

  <span class="keyword">this</span>.__defineGetter__(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> {nodes:<span class="keyword">this</span>.nodes,edges:<span class="keyword">this</span>.edges} })
}

util.inherits(IperGraph, IperNode)

<span class="function"><span class="keyword">function</span> <span class="title">check</span><span class="params">(data)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>data.edges has existing nodeIds</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">for</span> (<span class="keyword">var</span> edgeId <span class="keyword">in</span> data.edges) {
    <span class="keyword">var</span> edgeData = data.edges[edgeId]
    <span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> edgeData) {
      <span class="keyword">var</span> nodeId = edgeData[i]
      <span class="keyword">if</span> (<span class="keyword">typeof</span> data.nodes[nodeId] === <span class="string">'undefined'</span>)
        <span class="keyword">throw</span> <span class="keyword">new</span> Error()
    }
  }
}
IperGraph.prototype.check = check

<span class="function"><span class="keyword">function</span> <span class="title">load</span><span class="params">(data)</span> {</span>
  <span class="keyword">try</span> {
    check(data)
  }
  <span class="keyword">catch</span> (er) { <span class="keyword">throw</span> er }</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>store a lookup of new &lt;--&gt; old ids</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> nu = {}</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>create new nodes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> data.nodes) {
    <span class="keyword">var</span> node = data.nodes[i]
    nu[node.id] = <span class="keyword">this</span>.createNode(node.data)
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>create new edges</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> data.edges) {
    <span class="keyword">var</span> edge = <span class="keyword">new</span> data.edges[i]
    <span class="keyword">var</span> nodeIds = []

    <span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> edge.nodeIds) {
      nodeId = edge.nodeIds[i]
      nodeIds.push(nu[nodeId])
    }

    <span class="keyword">this</span>.createEdge(nodeIds)
  }
}
IperGraph.prototype.load = load

<span class="function"><span class="keyword">function</span> <span class="title">createEdge</span><span class="params">(nodeIds)</span> {</span>
  <span class="keyword">return</span> <span class="keyword">new</span> IperEdge(nodeIds)
}
IperGraph.prototype.createEdge = createEdge

<span class="function"><span class="keyword">function</span> <span class="title">readEdge</span><span class="params">(id)</span> {</span>
  <span class="keyword">return</span> <span class="keyword">this</span>.edges[id]
}
IperGraph.prototype.readEdge = readEdge

<span class="function"><span class="keyword">function</span> <span class="title">updateEdge</span><span class="params">(id, nodeData)</span> {</span>
}
IperGraph.prototype.updateEdge = updateEdge

<span class="function"><span class="keyword">function</span> <span class="title">deleteEdge</span><span class="params">(id)</span> {</span>
  <span class="keyword">delete</span> <span class="keyword">this</span>.edges[id]
}
IperGraph.prototype.deleteEdge = deleteEdge

<span class="function"><span class="keyword">function</span> <span class="title">createNode</span><span class="params">(data)</span> {</span>
  <span class="keyword">var</span> node = <span class="keyword">new</span> IperNode(data)
  <span class="keyword">this</span>.nodes[node.id] = node
  <span class="keyword">return</span> node.id
}
IperGraph.prototype.createNode = createNode

<span class="function"><span class="keyword">function</span> <span class="title">getNode</span><span class="params">(id)</span> {</span>
  <span class="keyword">return</span> <span class="keyword">this</span>.nodes[id]
}
IperGraph.prototype.getNode = getNode

<span class="function"><span class="keyword">function</span> <span class="title">updateNode</span><span class="params">(id, nodeData)</span> {</span>
  <span class="keyword">this</span>.nodes[id] = nodeData
}
IperGraph.prototype.updateNode = updateNode

<span class="function"><span class="keyword">function</span> <span class="title">deleteNode</span><span class="params">(id)</span> {</span>
  <span class="keyword">delete</span> <span class="keyword">this</span>.nodes[id]
}
IperGraph.prototype.deleteNode = deleteNode

module.exports = IperGraph</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
